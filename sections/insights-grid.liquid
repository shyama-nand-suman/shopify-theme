{% schema %}
{
  "name": "Insights Masonry",
  "blocks": [
    {
      "type": "card",
      "name": "Insight Card",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Background image" },
        { "type": "text", "id": "title", "label": "Title" },
        { "type": "text", "id": "cta", "label": "CTA text", "default": "Explore Research" },
        { "type": "url", "id": "link", "label": "Link" },
        {
          "type": "select",
          "id": "layout",
          "label": "Card size",
          "default": "big",
          "options": [
            { "value": "big", "label": "Big (2x2)" },
            { "value": "tall", "label": "Tall (1x2)" },
            { "value": "small", "label": "Small (1x1)" }
          ]
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Insights Masonry",
      "blocks": [
        { "type": "card" },
        { "type": "card" },
        { "type": "card" },
        { "type": "card" },
        { "type": "card" },
        { "type": "card" }
      ]
    }
  ]
}
{% endschema %}

<section class="insights-wrap">
  {% for block in section.blocks %}
    <div class="insight {{ block.settings.layout }}" {{ block.shopify_attributes }}>
      <a
        href="{{ block.settings.link }}"
        class="insight-link"
        style="background-image:url({{ block.settings.image | image_url: width: 1600 }})"
      >
        <div class="info">
          <h3>{{ block.settings.title }}</h3>
          <span class="cta">
            {{ block.settings.cta }}
            <span class="arrow">â†’</span>
          </span>
        </div>
      </a>
    </div>
  {% endfor %}
</section>

<style>
/* ===== GRID FORCE ===== */
.insights-wrap{
  display:grid !important;
  grid-template-columns:repeat(3, minmax(0,1fr));
  grid-auto-rows:220px;
  gap:16px;
  width:100%;
}

/* ===== CARD WRAPPER ===== */
.insight{
  position:relative;
  overflow:hidden;
}

/* ===== CARD SIZES ===== */
.insight.big{
  grid-column:span 2;
  grid-row:span 2;
}

.insight.tall{
  grid-row:span 2;
}

.insight.small{
  grid-row:span 1;
}

/* ===== CLICKABLE AREA ===== */
.insight-link{
  position:absolute;
  inset:0;
  display:flex;
  align-items:flex-end;
  padding:24px;
  background-size:cover;
  background-position:center;
  text-decoration:none;
  color:#fff;
  transform:scale(1);
  transition:transform .5s ease;
}

/* ===== OVERLAY ===== */
.insight-link::before{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(
    180deg,
    rgba(0,0,0,.15),
    rgba(0,0,0,.85)
  );
  z-index:0;
  transition:.4s;
}

/* ===== CONTENT ===== */
.insight-link .info{
  position:relative;
  z-index:1;
}

.insight-link h3{
  font-size:20px;
  font-weight:600;
  margin-bottom:8px;
  max-width:90%;
}

.insight-link .cta{
  font-size:14px;
  display:inline-flex;
  align-items:center;
  gap:6px;
  opacity:.9;
}

.insight-link .arrow{
  transition:transform .3s ease;
}

/* ===== HOVER ===== */
.insight-link:hover{
  transform:scale(1.04);
}

.insight-link:hover::before{
  background:linear-gradient(
    180deg,
    rgba(0,0,0,.35),
    rgba(0,0,0,.95)
  );
}

.insight-link:hover .arrow{
  transform:translateX(6px);
}

/* ===== MOBILE ===== */
@media(max-width:900px){
  .insights-wrap{
    grid-template-columns:1fr;
  }

  .insight.big,
  .insight.tall{
    grid-column:span 1;
    grid-row:span 1;
  }
}
</style>
